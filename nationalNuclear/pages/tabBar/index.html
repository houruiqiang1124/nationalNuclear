<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="../../css/mui.min.css"/>
		<link rel="stylesheet" type="text/css" href="../../css/common.css"/>
	</head>
	<body>
		<nav class="mui-bar mui-bar-tab" id="bottomx">
			<a class="mui-tab-item mui-active" href="home.html">
				<img src="../../static/tab/tab1.png" alt="" class="mui-icon" />
				<span class="mui-tab-label">首页</span>
			</a>
			<a class="mui-tab-item" href="application.html">
				<img src="../../static/tab/tab2_.png" alt="" class="mui-icon" />
				<span class="mui-tab-label">公告</span>
			</a>
			<a class="mui-tab-item" href="mail.html">
				<img src="../../static/tab/tab3_.png" alt="" class="mui-icon" />
				<span class="mui-tab-label">通讯录</span>
			</a>
		</nav>
        	<script src="../../js/mui.min.js"></script>
        	<script type="text/javascript" src="../../js/jquery-3.2.1.min.js" ></script>
			<script src="../../js/common/config.js"></script>
            <script src="../../js/common/api.js"></script>
        	<script type="text/javascript" charset="utf-8">
        		mui.plusReady(function() {
        			var aniShow = {};
        			var subpages = ['home.html', 'application.html', 'mail.html'];
        			var subpage_style = {
        				top: '0',
        				bottom: '50px'
        			},
        			self = plus.webview.currentWebview(),
        			temp = {};
        			for(var i = 0; i < 1; i++) {
        				var sub = plus.webview.create(subpages[i], subpages[i], subpage_style)
        				if(i > 0) {
        					sub.hide()
        				}
        				temp[subpages[0]] = "true";
        				mui.extend(aniShow, temp);
        				plus.webview.currentWebview().append(sub);
        			}
        			var activeTab = subpages[0];
        			mui('.mui-bar-tab').on('tap', 'a', function(e) {
                        var types = {}; 
                        types[plus.networkinfo.CONNECTION_UNKNOW] = false; 
                        types[plus.networkinfo.CONNECTION_NONE] = false; 
                        types[plus.networkinfo.CONNECTION_ETHERNET] = true; 
                        types[plus.networkinfo.CONNECTION_WIFI] = true; 
                        types[plus.networkinfo.CONNECTION_CELL2G] = true; 
                        types[plus.networkinfo.CONNECTION_CELL3G] = true; 
                        types[plus.networkinfo.CONNECTION_CELL4G] = true;
                        var isNetwork = types[plus.networkinfo.getCurrentType()];
                        if(!isNetwork) {
                            return;
                        }
                        
                        // 隐藏公告里面的会议安排页面
                        if(plus.webview.getWebviewById("meeting.html")) {
                            plus.webview.getWebviewById("meeting.html").hide();
                        }
                        
                        var tabIndex = $(this).index();
                        if(app.loginInfo.userType == 0 && tabIndex != 0) {
                            return;
                        }
        				var activeIndex = subpages.indexOf(activeTab);
        				var targetTab = this.getAttribute('href');
						if(plus.webview.getWebviewById(targetTab)){
							// plus.webview.show(targetTab);
						}else{
							plus.webview.create(targetTab, targetTab, subpage_style);
						}
        				if (targetTab == activeTab) {
        					return;
        				}else{
        					var imgs = '../../static/tab/tab' + ($(this).index() + 1) + '.png';
        					$(".mui-tab-item").eq(activeIndex).children("img").attr("src", '../../static/tab/tab' + (activeIndex + 1) + '_.png')
        					$(this).children("img").attr("src", imgs);
        				}
                        console.log(targetTab)
        				plus.webview.show(targetTab);
        				// self.append(sub);
        				//隐藏当前;
                        console.log(activeTab) 
        				plus.webview.hide(activeTab);
                        if(targetTab == "application.html") {
                            var noticeTab = localStorage.getItem("noticeTab");
                            if(noticeTab == 2) {
                                var view = plus.webview.getWebviewById("meeting.html");
                                if(view) {
                                    view.show();
                                }
                                
                            } 
                        }
        				//更改当前活跃的选项卡
        				activeTab = targetTab;
        			});
        			sne.quit();
        		});
        </script>
	</body>
</html>